<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tailwind to SenangStart CSS Converter</title>
    <!-- Tailwind CSS for the Tailwind preview -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- SenangStart CSS for the converted preview -->
    <script src="../dist/senangstart-css.min.js"></script>
    <style>
      body {
        font-family: system-ui, -apple-system, sans-serif;
        margin: 0;
        min-height: 100vh;
      }
      .converter-container {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 24px;
        padding: 24px;
        margin: 0 auto;
      }
      .panel {
        display: flex;
        flex-direction: column;
        gap: 16px;
      }
      .panel-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 12px 16px;
        border-radius: 8px 8px 0 0;
        color: white;
        font-weight: 600;
      }
      .panel-header.tailwind {
        background: linear-gradient(135deg, #38bdf8, #0ea5e9);
      }
      .panel-header.senangstart {
        background: linear-gradient(135deg, #8b5cf6, #6d28d9);
      }
      .code-input {
        width: 100%;
        height: 200px;
        padding: 16px;
        border: 2px solid #e5e7eb;
        border-radius: 8px;
        font-family: ui-monospace, monospace;
        font-size: 14px;
        line-height: 1.5;
        resize: vertical;
        background: #fafafa;
      }
      .code-input:focus {
        outline: none;
        border-color: #8b5cf6;
        box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
      }
      .preview-container {
        border: 2px solid #e5e7eb;
        border-radius: 8px;
        min-height: 200px;
        background: white;
      }
      .preview-header {
        padding: 8px 16px;
        background: #f9fafb;
        border-bottom: 1px solid #e5e7eb;
        font-size: 12px;
        font-weight: 500;
        color: #6b7280;
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }
      .preview-content {
        padding: 16px;
        min-height: 150px;
      }
      .header {
        text-align: center;
        padding: 32px 24px;
        background: linear-gradient(
          135deg,
          #0ea5e9 0%,
          #8b5cf6 50%,
          #6d28d9 100%
        );
        color: white;
      }
      .header h1 {
        margin: 0 0 8px 0;
        font-size: 28px;
      }
      .header p {
        margin: 0;
        opacity: 0.9;
      }
      .copy-btn {
        padding: 6px 12px;
        background: rgba(255, 255, 255, 0.2);
        border: 1px solid rgba(255, 255, 255, 0.3);
        border-radius: 6px;
        color: white;
        font-size: 12px;
        cursor: pointer;
        transition: all 0.2s;
      }
      .copy-btn:hover {
        background: rgba(255, 255, 255, 0.3);
      }
      .options {
        display: flex;
        gap: 16px;
        padding: 16px 24px;
        background: #f9fafb;
        border-bottom: 1px solid #e5e7eb;
        justify-content: center;
        align-items: center;
      }
      .option-label {
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 14px;
        color: #374151;
        cursor: pointer;
      }
      .status {
        text-align: center;
        padding: 8px;
        font-size: 13px;
        color: #6b7280;
      }
      .status.success {
        color: #10b981;
      }
      @media (max-width: 900px) {
        .converter-container {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <div class="header">
      <h1>Tailwind â†’ SenangStart CSS Converter</h1>
      <p>
        Paste Tailwind CSS code on the left, see the converted SenangStart CSS
        on the right
      </p>
    </div>

    <div class="options">
      <label class="option-label">
        <input type="checkbox" id="exactMode" />
        <span>Exact Mode (use tw- prefix for numeric scales)</span>
      </label>
      <label class="option-label">
        <input type="checkbox" id="livePreview" checked />
        <span>Live Preview</span>
      </label>
    </div>

    <div class="converter-container">
      <!-- Tailwind Panel -->
      <div class="panel">
        <div class="panel-header tailwind">
          <span>Tailwind CSS</span>
          <button class="copy-btn" onclick="copyInput()">Copy</button>
        </div>
        <textarea
          id="tailwindInput"
          class="code-input"
          placeholder="Paste your Tailwind HTML here..."
        ></textarea>
        <div class="preview-container">
          <div class="preview-header">Tailwind Preview</div>
          <div class="preview-content" id="tailwindPreview"></div>
        </div>
      </div>

      <!-- SenangStart Panel -->
      <div class="panel">
        <div class="panel-header senangstart">
          <span>SenangStart CSS</span>
          <button class="copy-btn" onclick="copyOutput()">Copy</button>
        </div>
        <textarea
          id="senangstartOutput"
          class="code-input"
          placeholder="Converted SenangStart CSS will appear here..."
          readonly
        ></textarea>
        <div class="preview-container">
          <div class="preview-header">SenangStart Preview</div>
          <div class="preview-content" id="senangstartPreview"></div>
        </div>
      </div>
    </div>

    <div class="status" id="status"></div>

    <script>
      // ============================
      // BROWSER-COMPATIBLE CONVERTER
      // ============================

      const spacingScale = {
        0: "none",
        px: "[1px]",
        0.5: "tiny",
        1: "tiny",
        1.5: "tiny",
        2: "tiny",
        2.5: "small",
        3: "small",
        3.5: "small",
        4: "small",
        5: "medium",
        6: "medium",
        7: "medium",
        8: "big",
        9: "big",
        10: "big",
        11: "big",
        12: "giant",
        14: "giant",
        16: "giant",
        20: "vast",
        24: "vast",
        28: "vast",
        32: "vast",
        36: "vast",
        40: "vast",
        44: "vast",
        48: "vast",
        52: "vast",
        56: "vast",
        60: "vast",
        64: "vast",
        72: "vast",
        80: "vast",
        96: "vast",
        full: "[100%]",
        screen: "[100vw]",
        auto: "auto",
      };

      const radiusScale = {
        none: "none",
        sm: "small",
        "": "small",
        md: "medium",
        lg: "medium",
        xl: "big",
        "2xl": "big",
        "3xl": "big",
        full: "round",
      };
      const shadowScale = {
        sm: "small",
        "": "small",
        md: "medium",
        lg: "big",
        xl: "giant",
        "2xl": "giant",
        none: "none",
      };
      const fontSizeScale = {
        xs: "mini",      // 0.75rem
        sm: "small",     // 0.875rem
        base: "base",    // 1rem
        lg: "large",     // 1.125rem
        xl: "big",       // 1.25rem
        "2xl": "huge",   // 1.5rem
        "3xl": "grand",  // 1.875rem
        "4xl": "giant",  // 2.25rem
        "5xl": "mount",  // 3rem
        "6xl": "mega",   // 3.75rem
        "7xl": "giga",   // 4.5rem
        "8xl": "tera",   // 6rem
        "9xl": "hero",   // 8rem
      };

      const layoutMappings = {
        container: "container",
        flex: "flex",
        "inline-flex": "inline-flex",
        grid: "grid",
        "inline-grid": "inline-grid",
        block: "block",
        "inline-block": "inline",
        hidden: "hidden",
        "flex-row": "row",
        "flex-col": "col",
        "flex-row-reverse": "row-reverse",
        "flex-col-reverse": "col-reverse",
        "flex-wrap": "wrap",
        "flex-nowrap": "nowrap",
        "flex-wrap-reverse": "wrap-reverse",
        "flex-grow": "grow",
        "flex-grow-0": "grow-0",
        grow: "grow",
        "grow-0": "grow-0",
        "flex-shrink": "shrink",
        "flex-shrink-0": "shrink-0",
        shrink: "shrink",
        "shrink-0": "shrink-0",
        "flex-1": "flex:1",
        "flex-auto": "flex:auto",
        "flex-initial": "flex:initial",
        "flex-none": "flex:none",
        "justify-start": "justify:start",
        "justify-end": "justify:end",
        "justify-center": "justify:center",
        "justify-between": "justify:between",
        "justify-around": "justify:around",
        "justify-evenly": "justify:evenly",
        "items-start": "items:start",
        "items-end": "items:end",
        "items-center": "items:center",
        "items-baseline": "items:baseline",
        "items-stretch": "items:stretch",
        "self-auto": "self:auto",
        "self-start": "self:start",
        "self-end": "self:end",
        "self-center": "self:center",
        "self-stretch": "self:stretch",
        relative: "relative",
        absolute: "absolute",
        fixed: "fixed",
        sticky: "sticky",
        static: "static",
        "overflow-auto": "overflow:auto",
        "overflow-hidden": "overflow:hidden",
        "overflow-visible": "overflow:visible",
        "overflow-scroll": "overflow:scroll",
        "object-contain": "object:contain",
        "object-cover": "object:cover",
        "object-fill": "object:fill",
        "object-none": "object:none",
        "object-scale-down": "object:scale-down",
      };

      const visualKeywords = {
        italic: "italic",
        "not-italic": "not-italic",
        antialiased: "antialiased",
        uppercase: "uppercase",
        lowercase: "lowercase",
        capitalize: "capitalize",
        "normal-case": "normal-case",
        underline: "underline",
        "line-through": "line-through",
        "no-underline": "no-underline",
        truncate: "truncate",
        "cursor-pointer": "cursor:pointer",
        "cursor-default": "cursor:default",
        "cursor-not-allowed": "cursor:not-allowed",
        "select-none": "select:none",
        "select-text": "select:text",
        "select-all": "select:all",
      };

      function getSpacing(value, exact) {
        if (exact) {
          if (["full", "screen", "auto"].includes(value))
            return spacingScale[value] || `[${value}]`;
          return `tw-${value}`;
        }
        return spacingScale[value] || `[${value}]`;
      }

      function convertClass(twClass, exact) {
        // Handle prefixes (hover:, sm:, md:, etc.)
        const prefixMatch = twClass.match(
          /^(sm:|md:|lg:|xl:|2xl:|hover:|focus:|active:|disabled:|dark:)(.+)$/
        );
        let prefix = "",
          baseClass = twClass;
        if (prefixMatch) {
          const rawPrefix = prefixMatch[1].slice(0, -1); // remove colon
          if (['sm', 'md', 'lg', 'xl', '2xl'].includes(rawPrefix)) {
            prefix = `tw-${rawPrefix}:`;
          } else {
            prefix = prefixMatch[1];
          }
          baseClass = prefixMatch[2];
        }

        // Layout mappings
        if (layoutMappings[baseClass])
          return { cat: "layout", val: prefix + layoutMappings[baseClass] };

        // Visual keywords
        if (visualKeywords[baseClass])
          return { cat: "visual", val: prefix + visualKeywords[baseClass] };

        // Text color
        const textColorMatch = baseClass.match(
          /^text-((?:slate|gray|zinc|neutral|stone|red|orange|amber|yellow|lime|green|emerald|teal|cyan|sky|blue|indigo|violet|purple|fuchsia|pink|rose|white|black)(?:-\d+)?)$/
        );
        if (textColorMatch)
          return { cat: "visual", val: prefix + "text:" + textColorMatch[1] };

        // Text alignment
        if (
          ["text-left", "text-center", "text-right", "text-justify"].includes(
            baseClass
          )
        )
          return {
            cat: "visual",
            val: prefix + "text:" + baseClass.replace("text-", ""),
          };

        // Text size
        const textSizeMatch = baseClass.match(
          /^text-(xs|sm|base|lg|xl|2xl|3xl|4xl|5xl|6xl|7xl|8xl|9xl)$/
        );
        if (textSizeMatch) {
          const size = exact
            ? `tw-${textSizeMatch[1]}`
            : fontSizeScale[textSizeMatch[1]] || textSizeMatch[1];
          return { cat: "visual", val: prefix + "text-size:" + size };
        }

        // Background color
        const bgMatch = baseClass.match(
          /^bg-((?:slate|gray|zinc|neutral|stone|red|orange|amber|yellow|lime|green|emerald|teal|cyan|sky|blue|indigo|violet|purple|fuchsia|pink|rose|white|black)(?:-\d+)?)$/
        );
        if (bgMatch) return { cat: "visual", val: prefix + "bg:" + bgMatch[1] };

        // Border color
        const borderColorMatch = baseClass.match(
          /^border-((?:slate|gray|zinc|neutral|stone|red|orange|amber|yellow|lime|green|emerald|teal|cyan|sky|blue|indigo|violet|purple|fuchsia|pink|rose|white|black)(?:-\d+)?)$/
        );
        if (borderColorMatch)
          return {
            cat: "visual",
            val: prefix + "border:" + borderColorMatch[1],
          };

        // Padding
        const paddingMatch = baseClass.match(/^p([trblxy])?-(.+)$/);
        if (paddingMatch) {
          const side = paddingMatch[1] ? "-" + paddingMatch[1] : "";
          return {
            cat: "space",
            val: prefix + "p" + side + ":" + getSpacing(paddingMatch[2], exact),
          };
        }

        // Margin
        const marginMatch = baseClass.match(
          /^-?m([trblxy])?-(\d+\.?\d*|px|auto|full|screen)$/
        );
        if (marginMatch) {
          const isNeg = baseClass.startsWith("-");
          const side = marginMatch[1] ? "-" + marginMatch[1] : "";
          let val = getSpacing(marginMatch[2], exact);
          if (isNeg) val = "[-" + val + "]";
          return { cat: "space", val: prefix + "m" + side + ":" + val };
        }

        // Gap
        const gapMatch = baseClass.match(/^gap-([xy])?-?(.+)$/);
        if (gapMatch) {
          const axis = gapMatch[1] ? "-" + gapMatch[1] : "";
          return {
            cat: "space",
            val: prefix + "g" + axis + ":" + getSpacing(gapMatch[2], exact),
          };
        }

        // Width/Height with special values
        const widthMatch = baseClass.match(/^(min-w|max-w|w)-(.+)$/);
        if (widthMatch) {
          const prop = widthMatch[1];
          const rawVal = widthMatch[2];
          // Special width values
          const specialWidthVals = { 'max': '[max-content]', 'min': '[min-content]', 'fit': '[fit-content]', 'prose': '[65ch]' };
          const val = specialWidthVals[rawVal] || getSpacing(rawVal, exact);
          return { cat: "space", val: prefix + prop + ":" + val };
        }
        const heightMatch = baseClass.match(/^(min-h|max-h|h)-(.+)$/);
        if (heightMatch) {
          const prop = heightMatch[1];
          const rawVal = heightMatch[2];
          const specialHeightVals = { 'screen': '[100vh]', 'svh': '[100svh]', 'lvh': '[100lvh]', 'dvh': '[100dvh]', 'max': '[max-content]', 'min': '[min-content]', 'fit': '[fit-content]' };
          const val = specialHeightVals[rawVal] || getSpacing(rawVal, exact);
          return { cat: "space", val: prefix + prop + ":" + val };
        }

        // Border radius
        const roundedMatch = baseClass.match(/^rounded(?:-(.+))?$/);
        if (roundedMatch) {
          const size = roundedMatch[1] || "";
          const scale = exact
            ? size === ""
              ? "tw-DEFAULT"
              : `tw-${size}`
            : radiusScale[size] || "medium";
          return { cat: "visual", val: prefix + "rounded:" + scale };
        }

        // Shadow
        const shadowMatch = baseClass.match(/^shadow(?:-(.+))?$/);
        if (shadowMatch) {
          const size = shadowMatch[1] || "";
          const scale = exact
            ? size === ""
              ? "tw-DEFAULT"
              : `tw-${size}`
            : shadowScale[size] || "medium";
          return { cat: "visual", val: prefix + "shadow:" + scale };
        }

        // Font weight
        const fontWeightMatch = baseClass.match(
          /^font-(thin|extralight|light|normal|medium|semibold|bold|extrabold|black)$/
        );
        if (fontWeightMatch)
          return { cat: "visual", val: prefix + "font:tw-" + fontWeightMatch[1] };

        // Border width
        const borderWidthMatch = baseClass.match(
          /^border(?:-([trblxy]))?(?:-(\d+))?$/
        );
        if (
          borderWidthMatch &&
          (borderWidthMatch[2] ||
            (!borderWidthMatch[1] && baseClass === "border"))
        ) {
          const side = borderWidthMatch[1]
            ? "-" + borderWidthMatch[1] + "-w"
            : "-w";
          const width = borderWidthMatch[2] || "1";
          return {
            cat: "visual",
            val: prefix + "border" + side + ":[" + width + "px]",
          };
        }

        // Order
        const orderMatch = baseClass.match(/^order-(\d+|first|last|none)$/);
        if (orderMatch) {
          return { cat: "layout", val: prefix + "order:" + orderMatch[1] };
        }

        // Grid columns
        const gridColsMatch = baseClass.match(/^grid-cols-(\d+|none)$/);
        if (gridColsMatch) {
          return { cat: "layout", val: prefix + "grid-cols:" + gridColsMatch[1] };
        }

        // Column span
        const colSpanMatch = baseClass.match(/^col-span-(\d+|full)$/);
        if (colSpanMatch) {
          return { cat: "layout", val: prefix + "col-span:" + colSpanMatch[1] };
        }

        // Grid rows
        const gridRowsMatch = baseClass.match(/^grid-rows-(\d+|none)$/);
        if (gridRowsMatch) {
          return { cat: "layout", val: prefix + "grid-rows:" + gridRowsMatch[1] };
        }

        // Row span
        const rowSpanMatch = baseClass.match(/^row-span-(\d+|full)$/);
        if (rowSpanMatch) {
          return { cat: "layout", val: prefix + "row-span:" + rowSpanMatch[1] };
        }

        // Opacity
        const opacityMatch = baseClass.match(/^opacity-(\d+)$/);
        if (opacityMatch) {
          return { cat: "visual", val: prefix + "opacity:" + opacityMatch[1] };
        }

        return null;
      }

      function convertClasses(classString, exact) {
        const classes = classString
          .trim()
          .split(/\s+/)
          .filter((c) => c);
        const layout = [],
          space = [],
          visual = [],
          unknown = [];

        for (const cls of classes) {
          const result = convertClass(cls, exact);
          if (result) {
            if (result.cat === "layout") layout.push(result.val);
            else if (result.cat === "space") space.push(result.val);
            else if (result.cat === "visual") visual.push(result.val);
          } else {
            unknown.push(cls);
          }
        }

        return { layout, space, visual, unknown };
      }

      function convertHTML(html, exact) {
        return html.replace(
          /class=(["'])([^"']+)\1/g,
          (match, quote, classValue) => {
            const { layout, space, visual, unknown } = convertClasses(
              classValue,
              exact
            );
            const attrs = [];
            if (layout.length) attrs.push(`layout="${layout.join(" ")}"`);
            if (space.length) attrs.push(`space="${space.join(" ")}"`);
            if (visual.length) attrs.push(`visual="${visual.join(" ")}"`);
            if (unknown.length) attrs.push(`class="${unknown.join(" ")}"`);
            return attrs.join(" ") || 'class=""';
          }
        );
      }

      // ============================
      // UI LOGIC
      // ============================

      const tailwindInput = document.getElementById("tailwindInput");
      const senangstartOutput = document.getElementById("senangstartOutput");
      const tailwindPreview = document.getElementById("tailwindPreview");
      const senangstartPreview = document.getElementById("senangstartPreview");
      const exactMode = document.getElementById("exactMode");
      const livePreview = document.getElementById("livePreview");
      const status = document.getElementById("status");
      let debounceTimer;

      function convert() {
        const input = tailwindInput.value.trim();
        if (!input) {
          senangstartOutput.value = "";
          tailwindPreview.innerHTML = "";
          senangstartPreview.innerHTML = "";
          status.textContent = "";
          return;
        }

        const converted = convertHTML(input, exactMode.checked);
        senangstartOutput.value = converted;

        if (livePreview.checked) {
          tailwindPreview.innerHTML = input;
          senangstartPreview.innerHTML = converted;
          // Trigger SenangStart rescan
          if (window.SenangStart && window.SenangStart.scanAndGenerate) {
            window.SenangStart.scanAndGenerate();
          }
        }

        status.textContent = "Converted successfully!";
        status.className = "status success";
      }

      function debouncedConvert() {
        clearTimeout(debounceTimer);
        debounceTimer = setTimeout(convert, 300);
      }
      tailwindInput.addEventListener("input", debouncedConvert);
      exactMode.addEventListener("change", convert);
      livePreview.addEventListener("change", convert);

      window.copyInput = () => {
        navigator.clipboard.writeText(tailwindInput.value);
        status.textContent = "Tailwind code copied!";
        status.className = "status success";
      };
      window.copyOutput = () => {
        navigator.clipboard.writeText(senangstartOutput.value);
        status.textContent = "SenangStart code copied!";
        status.className = "status success";
      };

      // Load example
      tailwindInput.value = `<div class="flex items-center justify-between p-4 bg-blue-500 text-white rounded-lg shadow-lg">
  <h2 class="text-xl font-bold">Hello World</h2>
  <button class="px-4 py-2 bg-white text-blue-500 rounded hover:bg-blue-100">
    Click me
  </button>
</div>`;
      convert();
    </script>
  </body>
</html>
